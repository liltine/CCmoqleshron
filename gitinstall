local function printUsage()
	print( "Usages:" )
	print( "gitinstall <user> <repository> <branch> <package>" )
end

local tArgs = { ... }
if #tArgs < 4 then
	printUsage()
	return
end

if not http then
	print( "gitinstall requires http API" )
	print( "Set enableAPI_http to 1 in mod_ComputerCraft.cfg" )
	return
end

local luser = tArgs[1]
local lrepo = tArgs[2]
local lbranch = tArgs[3]
local lpackage = tArgs[4]

local function getfile(user , repository , branch , filepath)
	write( "Retriving "..filepath.." from raw gitHub .. ")
	local response = http.get("https://raw.github.com/"..textutils.urlEncode( user ).."/"..textutils.urlEncode( repository ).."/"..textutils.urlEncode( branch ).."/"..filepath)
	if response then
		print( "Success." )
		local fileData = {}
		local line = response.readLine()
		repeat
			table.insert(fileData,line)
			line = response.readLine()
		until line == nil
		response.close()
		return fileData
	else
		print( "Failed." )
		response.close()
		return 0
	end
end

local filelist = getfile(luser, lrepo, lbranch, lpackage)
print("got filelist for package : ".. lpackage)
for index,filepath in ipairs(filelist) do
	local filedata = getfile(luser, lrepo, lbranch, filepath)
	local file = fs.open( filepath, "w" )
	for lineIndex,line in ipairs(filedata) do
		file.writeLine(line)
	end
	fs.close()
	print( "saved as : ".. filepath)
end